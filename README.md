# TCP通信Demo

这是一个TCP通信演示程序，包含命令行版本的服务端和客户端，以及一个功能完整的Qt图形界面版本。

## 功能特点

### 命令行版本
- 简单的TCP服务端和客户端
- 服务端支持单客户端连接
- 支持优雅退出（Ctrl+C）

### Qt图形界面版本
- **双模式支持**：可选择作为服务端或客户端运行
- **多窗口支持**：可以同时开启多个窗口，分别作为服务端和客户端
- **实时通信**：支持实时消息收发
- **回车发送**：在消息输入框按回车键即可发送消息
- **服务端广播**：服务端可以向所有连接的客户端广播消息
- **连接状态显示**：实时显示连接状态和客户端数量
- **日志记录**：详细的通信日志记录

## 编译方法

### 系统要求
- 支持C++11的编译器（如GCC 4.8+）
- CMake 3.10或更高版本
- Qt6开发库（Core、Widgets、Network模块）
- POSIX兼容系统（Linux、macOS等）

### 安装Qt6依赖

#### Ubuntu/Debian
```bash
sudo apt-get update
sudo apt-get install qt6-base-dev qt6-tools-dev cmake build-essential
```

#### 手动安装Qt6
如果系统包管理器中没有Qt6，可以从[Qt官网](https://www.qt.io/download)下载并安装。

### 使用CMake构建

1. 创建构建目录并进入：
```bash
mkdir build && cd build
```

2. 生成构建文件：
```bash
cmake ..
```

3. 编译项目：
```bash
make -j$(nproc)
```

## 运行方法

### 命令行版本

#### 运行服务端
```bash
./tcp_server
```
服务端将在8888端口监听连接请求。

#### 运行客户端
```bash
./tcp_client
```
客户端将尝试连接到本地（127.0.0.1）的服务端8888端口。

### Qt图形界面版本

```bash
./qt_client
```

#### 使用说明

1. **选择模式**：
   - 在界面顶部选择"服务端"或"客户端"模式
   - 模式选择后相应的控件会显示/隐藏

2. **服务端模式**：
   - 设置监听端口（默认8888）
   - 点击"启动"按钮开始监听
   - 状态栏会显示连接的客户端数量
   - 可以向所有连接的客户端广播消息

3. **客户端模式**：
   - 设置服务器地址和端口
   - 点击"连接"按钮连接到服务器
   - 连接成功后可以发送消息

4. **发送消息**：
   - 在消息输入框中输入文本
   - 点击"发送"按钮或按回车键发送

5. **多窗口使用**：
   - 通过菜单"文件" -> "新建窗口"可以打开新窗口
   - 每个窗口可以独立设置为服务端或客户端
   - 例如：一个窗口作为服务端，另一个作为客户端进行测试

## 自定义配置

### 修改默认端口
可以直接在界面中修改端口号，或者修改源代码中的默认值。

### 修改默认服务器地址
在客户端模式下可以修改服务器地址，默认为127.0.0.1（本地）。

## 使用示例

1. 启动第一个窗口，选择"服务端"模式，端口设为8888，点击"启动"
2. 通过菜单打开第二个窗口，选择"客户端"模式，服务器地址127.0.0.1，端口8888，点击"连接"
3. 在客户端窗口输入消息并发送，服务端会收到并回复
4. 可以开启更多客户端窗口连接到同一个服务端

## 项目结构

```
TCPDemo/
├── CMakeLists.txt          # CMake构建配置
├── README.md              # 说明文档
├── tcp_server.cpp         # 命令行服务端
├── tcp_client.cpp         # 命令行客户端
├── qt_client.cpp          # Qt应用入口
├── mainwindow.h           # Qt主窗口头文件
├── mainwindow.cpp         # Qt主窗口实现
└── mainwindow.ui          # Qt界面设计文件
``` 